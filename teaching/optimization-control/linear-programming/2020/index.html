
<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BMCXPTC2YB"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-BMCXPTC2YB');</script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Linear programming 2020</title>
    <link rel="stylesheet" href="../../../../source/styles.css">
    <link rel="stylesheet" href="../../../../source/pure-min.css">
    <link rel="stylesheet" href="../../../../source/grids-responsive-min.css">
    <script src="../../../../source/scripts.js"></script>
    <script src="../../../../source/es5/tex-mml-chtml.js" async></script>
</head>

<body>

<div class="pure-g">

<div class="pure-u-1 pure-u-md-4-5">
    <article>
        <h1>Linear programming</h1>

        <h3 id="0_anchor">Exercise 1</h3>

        <div class="exercise">
            <p>Consider a linear program in its standard form:</p>
                <ol type="i">
                    <li id="0_i_anchor">define formally the linear program using its general minimization expression, and</li>
                    <li id="0_ii_anchor">derive the KKT conditions for such a program.</li>
                </ol>
            </p>
        </div>

        <div class="hint">
            <p>What is a <b>Linear Program</b> or LP?</p>
            <p><span class="important">def</span>: Linear program is an optimization problems with a linear objective function \(J\) and linear constraints \(\mathbf{c}(\mathbf{x})\), which may include both equalities and inequalities. Linear programs are usually stated and analyzed in the following standard form <a href="#0_i_anchor">[i]</a>:</p>
            <div class="equation">$$
                \min_{\mathbf{x}\in\mathbb{R}^n}{J(\mathbf{x})=\mathbf{c}^T\mathbf{x}\,\,\,\text{s.t.}\,\,\,A\mathbf{x}=\mathbf{b},\,\mathbf{x}\geq 0},
            $$</div>
            <p>where \(\mathbf{c}\in\,\mathbb{R}^n,\,b\in\,\mathbb{R}^m\) and \(A\in\,\mathbb{R}^{m\times n}\).</p>
        </div>

        <p>The Lagrangian of the linear program in it's standard form can be expressed:</p>
        <div class="equation">$$
            \mathcal{L}(\mathbf{x},\mathbf{\lambda})=\mathbf{c}^T\mathbf{x}-\mathbf{\lambda}_1^T(\mathbf{A}\mathbf{x}-\mathbf{b})-\mathbf{\lambda}_2^T\mathbf{x}
        $$</div>
        <p>where \(\mathbf{\lambda}_1\,\in\,\mathbb{R}^m\) and \(\mathbf{\lambda}_2\,\in\,\mathbb{R}^n\) are the Lagrange multipliers (or better, vectors of lagrange multipliers as we are speaking in general terms) for the equality and the inequality constraint. The gradient of such a Lagrangian yields to:
        </p>
        <div class="equation">$$
            \nabla_\mathbf{x}\mathcal{L}(\mathbf{x}^*,\mathbf{\lambda}^*)=\mathbf{c}-(\mathbf{\lambda}_1^{*T}\mathbf{A})^T-\mathbf{\lambda}_2^*,
        $$</div>
        <p>note that this is possible because both cost function and constraints are linear. The KKT conditions can be expressed <a href="#0_ii_anchor">[ii]</a>:
            <ol type="1">
                <li>\(\mathbf{A}^T\mathbf{\lambda}_1^*+\mathbf{\lambda}_2^*-\mathbf{c}=0\),</li>
                <li>\(\mathbf{A}\mathbf{x}^*-\mathbf{b}=0\),</li>
                <li>\(\mathbf{x}^*\geq 0\),</li>
                <li>\(\mathbf{\lambda}_2\geq 0 \), and</li>
                <li>\(\mathbf{\lambda}_2^*\mathbf{x}_i^*=0\).</li>
            </ol>
        </p>

        <h3>Exercise 2</h3>
        
        <div class="exercise">
            <p>Consider the standard form of a linear program (this is the exercise on page 390 n. 13.5 in the textbook):</p>
            <div class="equation">$$\min_{\mathbf{x}\in\mathbb{R}^n}{J(\mathbf{x})=\mathbf{c}^T\mathbf{x}\,\,\,\text{s.t.}\,\,\,A\mathbf{x}\geq\mathbf{b},\,\mathbf{x}\geq 0},$$</div>
            <p>with \(\mathbf{c}\in\,\mathbb{R}^n,\,b\in\,\mathbb{R}^m\) and \(A\in\,\mathbb{R}^{m\times n}\):
                <ol type="i">
                    <li id="1_i_anchor">show that its dual is expressed (with \(\mathbf{\lambda}\in\,\mathbb{R}^m\)):</li>
                </ol>
            </p>
            <div class="equation">$$\max_{\mathbf{\lambda}\in\mathbb{R}^m}{J(\mathbf{\lambda})=\mathbf{b}^T\mathbf{\lambda}\,\,\,\text{s.t.}\,\,\,A^T\mathbf{\lambda}\leq \mathbf{c},\,\mathbf{\lambda}\geq 0}.$$</div>
        </div>

        <h3>Exercise 3</h3>

        <div class="exercise">
            <p>Two process stages are involved in the production of gold of different carats (kt). Let's suppose a gold production factory in Denmark profits 40 dollars per gram of 18 kt gold, 30 dollars for 14 kt gold, and 20 dollars for 10 kt gold.</p>
            <p>To make a gold ingot of 1 kg, the following times in each process stage are required:
                <ol type="1">
                    <li>1 kg of 18 kt gold requires 3 hours in the first, 2 hours in the second stage,</li>
                    <li>1 kg of 14 kt gold requires 2 hours in the first, 2 hours in the second stage, and</li>
                    <li>1 kg of 10 kt gold requires 1 hour in the first, 3 hours in the second stage.</li>
                </ol>
                During 1 year, the first stage has 7 200 hours and the second stage has 6 000 hours production time available. The rest is needed due to the maintenance of the production line. The available time should be fully utilized.
            </p>
            <p>We wish to maximize the yearly profit.</p>
            <p>
                <ol type="i">
                    <li id="2_i_anchor">define the LP,</li>
                    <li id="2_ii_anchor">use some of the KKT conditions to identify the points of the optimization problem that might be optimal, and</li>
                    <li id="2_iii_anchor">show which of the points found at the previous step respect all the KKT conditions.</li>
                </ol>
            </p>
        </div>

        <p>Wishing to maximize the profit, means minimizing its negative; so let's impose as the decision variable \(\mathbf{x}=(x_1\,\,\,x_2\,\,\,x_3)^T\) the kg of gold manufactured, and as \(\mathbf{c}\) the negative of the profits per kg of different ingots, i.e., \(\mathbf{c}=-10^4(4\,\,\,3\,\,\,2)^T\). Decision variables are the unknowns of a mathematical programming model - e.g., the amount of gold manufactured. In this exercise we are determining their optimum values with an optimization method. To be exact, here we are expressing KKT conditions so we are doing it analytically. You can later use an optimization method to establish them numerically (i.e., Matlab script that uses the Simplex method).
        </p>
        <p>The profit can be written:</p>
        <div class="equation">$$
            -\mathbf{c}^T\mathbf{x}=-c_1x_1-c_2x_2-c_3x_3=4\cdot 10^4x_1+3\cdot 10^4x_2+2\cdot 10^4x_3
        $$</div>
        <p>For the two stages and their per-year time constraint, the objective function can be expressed in the following form:</p>
        <div class="equation">$$
            3x_1+2x_2+1x_3=7.2\cdot 10^3,
        $$$$
            2x_1+2x_2+3x_3=6\cdot 10^3,
        $$</div>
        <p>which can be clearly expressed in the form \(\mathbf{A}\mathbf{x}=\mathbf{b}\) given:</p>
        <div class="equation">$$
            \mathbf{A}=\begin{pmatrix}\,3&2&1\,\\2&2&3
            \end{pmatrix},\,\,\,\,\,\,\mathbf{b}=10^3\begin{pmatrix}\,7.2\,\\6\end{pmatrix},
        $$</div>
        <p>we cannot produce a negative amount of ingots, thus \(\mathbf{x}\geq 0\) holds, and the problem can be stated as follows <a href="#2_i_anchor">[i]</a>:</p>
        <div class="equation">$$
            \min_{\mathbf{x}\in\mathbb{R}^3}{J(\mathbf{x})=-10^4(4\,\,\,3\,\,\,2)\mathbf{x}\,\,\,\text{s.t.}\,\,\,\begin{pmatrix}\,3&2&1\,\\2&2&3
            \end{pmatrix}\mathbf{x}=10^3\begin{pmatrix}\,7.2\,\\6\end{pmatrix},\,\mathbf{x}\geq 0}.
        $$</div>

        <p>Note that now you can use what you wrote previously in Exercise <a href="#0_anchor">[1]</a>.The Lagrangian can be expressed with the following equation, where \(\mathbf{\lambda}_1\in\mathbb{R}^2\) and \(\mathbf{\lambda}_2\in\mathbb{R}^3\):</p>
        <div class="equation">$$
            \mathcal{L}(\mathbf{x},\mathbf{\lambda})=J(\mathbf{x})-\mathbf{\lambda}_1\left(
                \begin{pmatrix}\,3&2&1\,\\2&2&3\end{pmatrix}
                \mathbf{x}-10^3
                \begin{pmatrix}\,7.2\,\\6\end{pmatrix}
            \right)-\mathbf{\lambda}_2(\mathbf{x}),
        $$</div>
        <p>the stationary KKT condition \(\nabla_{\mathbf{x}}\mathcal{L}(\mathbf{x}^*,\mathbf{\lambda}^*)=0\) can be written:</p>
        <div class="equation">$$
            \nabla_{\mathbf{x}}\mathcal{L}(\mathbf{x}^*,\mathbf{\lambda}^*)=
            -10^4\begin{pmatrix}\,4\,\\3\\2\end{pmatrix}-\left(
                (\lambda_{1,1}\,\,\,\lambda_{1,2})\begin{pmatrix}\,3&2&1\,\\2&2&3\end{pmatrix}
            \right)^T-\begin{pmatrix}\,\lambda_{2,1}\,\\\lambda_{2,2}\\\lambda_{2,3}\end{pmatrix}=
            \begin{pmatrix}
                -4\cdot 10^4-3\lambda_{1,1}-2\lambda_{1,2}-\lambda_{2,1}\\
                -3\cdot 10^4-2\lambda_{1,1}-2\lambda_{1,2}-\lambda_{2,2}\\
                -2\cdot 10^4-\lambda_{1,1}-3\lambda_{1,2}-\lambda_{2,3}
            \end{pmatrix}=0,
        $$</div>
        <p>which gives us the values of \(\mathbf{\lambda}^*\) such that the above equation is satisfied. Now let's use the second KKT condition \(c_i(\mathbf{x})=0\) to find the optimal decision variable (amount of gold manufactured) \(\mathbf{x}^*\)</p>
        <div class="equation">$$
            c(\mathbf{x}^*)=\mathbf{A}\mathbf{x}-\mathbf{b}=\begin{pmatrix}
                3x_1+2x_2+x_3-7.2\cdot 10^3\\
                2x_1+2x_2+3x_3-6\cdot 10^3
            \end{pmatrix}=0,
        $$</div>
        <p>as you can see, we have just two equation in a system of three variables. We need thus to differentiate the problem in three sub-classes, by eliminating variables one-by-one <a href="#2_ii_anchor">[ii]</a>:
            <ol type="a">
                <li>when \(x_1=0,\,\mathbf{x}^*=(0\,\,\,3900\,\,\,-600)\), note that this point is infeasible, so it cannot be an optimal point (you cannot have a negative product, as you don't respect the equality constraint),</li>
                <li>when \(x_2=0,\,\mathbf{x}^*=\frac{1}{7}(15600\,\,\,0\,\,\,3600)\), and</li>
                <li>when \(x_3=0,\,\mathbf{x}^*=(1200\,\,\,1800\,\,\,0)\).</li>
            </ol>
            which gives us the values of the possible candidates for optimal points (due to the convexity of linear programs, KKT conditions are both necessary and sufficient).
        </p>
        <p>Let's check if KKT holds for these points. The point \(\mathbf{x}^*=(0\,\,\,3900\,\,\,-600)\) clearly does not satisfy KKT conditions, as it is not feasible.</p>
        <p>So let's check the point \(\mathbf{x}^*=\frac{1}{7}(15600\,\,\,0\,\,\,3600)\). From the last KKT condition \(\mathbf{\lambda}_2^*\mathbf{x}_i^*=0,\) we know that either \(\lambda_{2,i}\) is zero, or the decision variable is zero:</p>
        <div class="equation">$$
            \nabla_{\mathbf{x}}\mathcal{L}(\mathbf{x}^*,\mathbf{\lambda}^*)=
            \begin{pmatrix}
                -40 000-3\lambda_{1,1}-2\lambda_{1,2}\\
                -30 000-2\lambda_{1,1}-2\lambda_{1,2}-\lambda_{2,2}\\
                -20 000-\lambda_{1,1}-3\lambda_{1,2}
            \end{pmatrix}=0,
        $$</div>
        <p>this results in \(\lambda_{2,2}=-\frac{10000}{7}\). Now remember the KKT condition \(\mathbf{\lambda}_2\geq 0 \), which is not respected. Thus this is not the optimal point. 
        </p>
        <p>Finally let's check the point \(\mathbf{x}^*=(1200\,\,\,1800\,\,\,0)\):</p>
        <div class="equation">$$
            \nabla_{\mathbf{x}}\mathcal{L}(\mathbf{x}^*,\mathbf{\lambda}^*)=
            \begin{pmatrix}
                -40 000-3\lambda_{1,1}-2\lambda_{1,2}\\
                -30 000-2\lambda_{1,1}-2\lambda_{1,2}\\
                -20 000-\lambda_{1,1}-3\lambda_{1,2}-\lambda_{2,3}
            \end{pmatrix}=0,
        $$</div>
        <p>this result in \(\lambda_{2,3}=5000\). Which respect all the KKT conditions. This is henceforth the optimal point <a href="#2_iii_anchor">[iii]</a>. 
        </p>
    </article>
</div>

<div id="menu-div1" class="pure-u-1 pure-u-md-1-5">
    <header id="menu-header">
        <nav><div id="menu-div2" class="pure-menu custom-restricted-width"><ul class="pure-menu-list">
            <li class="pure-menu-item"><a href="/" class="pure-menu-link">[ Index ]</a></li>
            <li class="pure-menu-item"><a href="/publications" class="pure-menu-link">[ Publications ]</a></li>
            <li class="pure-menu-item pure-menu-selected"><a href="/teaching" class="pure-menu-link">[ Teaching ]</a></li>
        </ul></div></nav>
    </header>                    
</div>    
</div>

</body>

</html>
